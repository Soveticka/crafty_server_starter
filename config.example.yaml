# ═══════════════════════════════════════════════════════════════════
# Crafty Server Watcher — configuration
# ═══════════════════════════════════════════════════════════════════
# Copy this file to /etc/crafty-server-watcher/config.yaml and edit.
# The API token is NOT stored here — set the environment variable
# referenced by crafty.api_token_env (default: CRAFTY_API_TOKEN).
# ═══════════════════════════════════════════════════════════════════

# ── Crafty API connection ───────────────────────────────────────
crafty:
  base_url: "https://crafty_ip:8443"   # IP address of the Crafty server
  api_token_env: "CRAFTY_API_TOKEN"    # env var that holds the token
  verify_tls: true                      # true for Let's Encrypt certs

# ── Servers to manage ───────────────────────────────────────────
# Each key is a friendly name.  You need the Crafty server UUID
# (visible in the Crafty dashboard URL or via GET /api/v2/servers).
servers:
  vanilla:
    crafty_server_id: "5adcec83-684c-4555-a7e9-9d913203d07e"
    listen_port: 25565
    listen_host: "0.0.0.0"
    edition: java               # "java" (TCP) or "bedrock" (UDP/RakNet)
    idle_timeout_minutes: 10
    start_timeout_seconds: 180
    motd_hibernating: "§7⏳ Server is hibernating. Connect to wake it up!"
    kick_message: "§eServer is starting up!\n§7Please reconnect in about 60 seconds."

  modded:
    crafty_server_id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
    listen_port: 25566
    listen_host: "0.0.0.0"
    edition: java
    idle_timeout_minutes: 15
    start_timeout_seconds: 300
    motd_hibernating: "§7⏳ Modded server sleeping. Connect to wake it!"
    kick_message: "§eModded server is booting!\n§7Please reconnect in ~2 minutes."

  bedrock-survival:
    crafty_server_id: "b2c3d4e5-f6a7-8901-bcde-f12345678901"
    listen_port: 19132
    listen_host: "0.0.0.0"
    edition: bedrock            # Bedrock uses UDP (RakNet) on port 19132
    idle_timeout_minutes: 10
    start_timeout_seconds: 120
    motd_hibernating: "Server hibernating - connect to wake up!"

# ── Polling ─────────────────────────────────────────────────────
polling:
  interval_seconds: 30
  api_retry_delay_seconds: 10
  api_max_retries: 3

# ── Anti-flap / cooldowns ──────────────────────────────────────
cooldowns:
  stop_cooldown_minutes: 5
  start_grace_minutes: 3
  flap_window_minutes: 30
  flap_max_cycles: 3
  flap_backoff_minutes: 10

# ── Logging ─────────────────────────────────────────────────────
logging:
  level: "INFO"
  file: "/var/log/crafty-server-watcher/service.log"
  max_bytes: 10485760    # 10 MB
  backup_count: 5

# ── Webhook notifications ─────────────────────────────────────
# Sends Discord embeds (or generic JSON POST) on:
#   server started, stopped, crashed
webhook:
  enabled: false
  url: "https://discord.com/api/webhooks/YOUR_ID/YOUR_TOKEN"
  label: "Crafty Server Watcher"    # shown in embed footer
# ── Health endpoint ───────────────────────────────────────────
health:
  enabled: true           # set to false to disable
  host: "127.0.0.1"       # bind address (use 0.0.0.0 to expose)
  port: 8095              # GET /health and GET /status

